An Updated Version of LSD migrated to C for performance